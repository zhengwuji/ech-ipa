# 网站监控工具

一个功能强大的Python应用程序，用于实时监控网站的产品信息变化（价格、销售量、评价等），自动记录变化并保存截图。

## 功能特性

- ✅ **实时监控**: 自动检测网站产品价格、销售量、评价等信息变化
- ✅ **变化记录**: 详细记录每次变化的时间、位置和内容
- ✅ **自动截图**: 检测到变化时自动保存截图作为证据
- ✅ **自定义区域**: 支持通过截图标记方式选择监控区域
- ✅ **灵活配置**: 可自定义保存路径、截图路径、检测间隔等
- ✅ **友好界面**: 直观的图形用户界面，操作简单
- ✅ **数据保存**: 所有变化数据以JSON格式保存，便于后续分析

## 系统要求

- Windows 10/11
- Python 3.9 或更高版本
- Chrome 浏览器（用于网页访问）

## 安装说明

### 方法一：使用预编译版本（推荐）

1. 前往 [Releases](https://github.com/zhengwuji/jianche1/releases) 页面
2. 下载最新版本的 `网站监控工具.exe`
3. 双击运行即可，无需安装Python环境

### 方法二：从源码运行

1. 克隆仓库：
```bash
git clone https://github.com/zhengwuji/jianche1.git
cd jianche1
```

2. 安装依赖：
```bash
pip install -r requirements.txt
```

3. 运行程序：
```bash
python main.py
```

## 使用说明

### 首次使用设置

1. **输入监控网址**
   - 在"监控网址"输入框中输入要监控的网站URL
   - 例如：`https://example.com/product/123`

2. **设置保存路径**
   - 点击"浏览"按钮选择数据保存位置
   - 默认保存在桌面 `jianche1` 文件夹
   - 程序会自动创建 `screenshots`（截图）和 `saved_data`（数据）子文件夹

3. **设置截图保存路径**
   - 可以自定义截图保存位置
   - 点击"浏览"按钮选择自定义路径

4. **设置检测间隔**
   - 在"检测间隔"中设置检查频率（单位：秒）
   - 最小间隔为60秒（1分钟）
   - 建议根据网站更新频率设置合理值

5. **添加监控区域**（可选）
   - 点击"添加监控区域（截图标记）"按钮
   - 输入区域名称（如"价格区域"、"销售量区域"等）
   - 输入坐标和尺寸，或使用浏览器工具辅助定位
   - 可以添加多个监控区域

6. **保存设置**
   - 完成所有设置后，点击"保存设置"按钮
   - 设置会自动保存到 `config.yaml` 文件中

### 开始监控

1. 确保已完成上述设置
2. 点击"开始监控"按钮
3. 程序会立即执行一次检查，然后按设定间隔自动检查
4. 当检测到变化时：
   - 变化信息会显示在"变化记录"区域
   - 自动保存截图到指定文件夹
   - 变化数据保存为JSON文件

### 变化记录说明

每次检测到变化时，程序会记录：
- **时间戳**: 变化发生的准确时间
- **变化字段**: 哪个信息发生了变化（价格/销售量/评价）
- **旧值和新值**: 变化前后的数值对比
- **截图文件**: 变化时的页面截图文件名

所有记录保存在 `saved_data` 文件夹中，文件名格式为：
```
change_log_YYYYMMDD_HHMMSS.json
```

### 配置文件说明

程序会在运行目录创建 `config.yaml` 配置文件，包含所有设置：

```yaml
save_path: "C:/Users/用户名/Desktop/jianche1"
screenshot_path: "C:/Users/用户名/Desktop/jianche1/screenshots"
data_path: "C:/Users/用户名/Desktop/jianche1/saved_data"
check_interval: 60
target_url: "https://example.com"
monitor_regions:
  - name: "价格区域"
    x: 100
    y: 200
    width: 300
    height: 50
last_data: {}
```

可以直接编辑此文件修改设置，但建议通过程序界面修改。

## 文件结构

```
jianche1/
├── main.py                 # 主程序入口
├── config.py              # 配置管理模块
├── version.py             # 版本管理模块
├── web_monitor.py         # 网页监控核心模块
├── github_push.py         # GitHub自动推送模块
├── requirements.txt       # Python依赖包
├── version.json          # 版本号文件（自动生成）
├── config.yaml           # 配置文件（自动生成）
├── ui/                   # UI界面模块
│   ├── __init__.py
│   ├── main_window.py    # 主窗口
│   └── region_selector.py # 区域选择器
├── screenshots/          # 截图文件夹（自动创建）
├── saved_data/           # 数据保存文件夹（自动创建）
└── README.md            # 本说明文件
```

## 技术说明

### 工作原理

1. 使用 Selenium WebDriver 控制 Chrome 浏览器访问目标网站
2. 使用 BeautifulSoup 解析网页HTML，提取产品信息
3. 通过CSS选择器匹配常见的产品信息元素（价格、销售量、评价等）
4. 对比新旧数据，检测变化
5. 发现变化时保存页面截图和详细日志

### 支持的网站类型

程序使用通用的CSS选择器，适用于大多数电商网站：
- 价格：`.price`, `.product-price`, `[class*="price"]` 等
- 销售量：`.sales`, `.product-sales`, `[class*="sales"]` 等
- 评价：`.rating`, `.product-rating`, `[class*="rating"]` 等

对于特殊网站，可能需要调整 `web_monitor.py` 中的选择器。

## 常见问题

### Q: 程序无法检测到变化？
A: 
- 检查网址是否正确
- 确认网站可以正常访问
- 可能需要添加自定义监控区域
- 检查浏览器是否正常安装

### Q: 截图保存失败？
A:
- 检查截图保存路径是否有写入权限
- 确保磁盘空间充足
- 检查路径中是否包含特殊字符

### Q: 检测间隔可以设置更小吗？
A: 程序限制最小检测间隔为60秒，避免对目标网站造成过大压力。

### Q: 如何监控多个网站？
A: 目前版本支持监控单个网站。如需监控多个网站，可以运行多个程序实例，每个实例监控一个网站。

### Q: 程序占用资源高吗？
A: 程序在监控时会运行Chrome浏览器（无头模式），占用一定内存。建议监控间隔不要设置过小。

## 开发说明

### 版本管理

程序使用自动版本管理：
- 版本号格式：`主版本.次版本.修订版本`（如 `1.0.00`）
- 每次代码提交会自动递增版本号
- 版本号范围：`1.0.00` 到 `9.9.99`，之后循环回到 `1.0.00`

### 自动构建和发布

项目使用 GitHub Actions 自动构建：
- 每次推送到 `main` 分支会自动触发构建
- 自动将程序打包成 Windows EXE 文件
- 自动发布到 Releases，版本号自动递增

## 更新日志

### v1.0.00 (初始版本)
- ✅ 基础监控功能
- ✅ 图形用户界面
- ✅ 自动截图保存
- ✅ 变化记录功能
- ✅ 自定义配置
- ✅ 区域监控支持

## 许可证

本项目采用 MIT 许可证。

## 贡献

欢迎提交 Issue 和 Pull Request！

## 联系方式

如有问题或建议，请通过 GitHub Issues 联系。

---

**注意**: 使用本工具监控网站时，请遵守目标网站的 robots.txt 和使用条款，合理设置检测间隔，避免对网站造成过大负担。

